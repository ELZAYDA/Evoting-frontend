<div class="admin-dashboard dark-mode">
  <!-- Header -->
  <div class="dashboard-header">
    <h1><i class="fa-solid fa-user-shield"></i> Admin Dashboard</h1>
    <p class="dashboard-subtitle">Manage Elections & Candidates</p>
        <button class="back-button" (click)="goBack()">‚Üê back</button>

  </div>

  <!-- System Info -->
  @if (systemInfo) {
  <div class="system-info-section">
    <div class="info-card">
      <div class="info-icon"><i class="fa-solid fa-server"></i></div>
      <div class="info-content">
        <h3><i class="fa-solid fa-circle-info"></i> System Information</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="label"><i class="fa-solid fa-circle"></i> Election Status:</span>
            <span class="value status" [class]="getStateClass(systemInfo.state.state)">
              {{ getStateName(systemInfo.state.state) }}
            </span>
          </div>
          <div class="info-item">
            <span class="label"><i class="fa-solid fa-users"></i> Candidates Count:</span>
            <span class="value">{{ systemInfo.contestantsCount }}</span>
          </div>
          <div class="info-item">
            <span class="label"><i class="fa-solid fa-code"></i> Contract Address:</span>
            <span class="value address">
              <i class="fa-solid fa-hashtag"></i>
              {{ systemInfo.contractAddress | slice:0:8 }}...{{ systemInfo.contractAddress | slice:-6 }}
            </span>
          </div>
          <div class="info-item">
            <span class="label"><i class="fa-solid fa-user-tie"></i> Administrator:</span>
            <span class="value address">
              <i class="fa-solid fa-id-card"></i>
              {{ systemInfo.admin | slice:0:8 }}...{{ systemInfo.admin | slice:-6 }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
  }

  <!-- Statistics -->
  <div class="stats-section">
    <h2><i class="fa-solid fa-chart-pie"></i> Election Statistics</h2>
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fa-solid fa-users"></i>
        </div>
        <div class="stat-content">
          <h3>{{ systemInfo?.contestantsCount || 0 }}</h3>
          <p>Total Candidates</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fa-solid fa-vote-yea"></i>
        </div>
        <div class="stat-content">
          <h3>{{ totalVotes }}</h3>
          <p>Total Votes</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fa-solid fa-percentage"></i>
        </div>
        <div class="stat-content">
          <h3>{{ totalVotes > 0 ? ((getWinnerVotes() / totalVotes) * 100).toFixed(1) : 0 }}%</h3>
          <p>Winner Percentage</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fa-solid fa-calculator"></i>
        </div>
        <div class="stat-content">
          <h3>{{ getStatusText(systemInfo?.state?.state) }}</h3>
          <p>Current Status</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <h2><i class="fa-solid fa-bolt"></i> Quick Actions</h2>
    
    <div class="actions-grid">
      <!-- Add Candidate -->
      <div class="action-card" (click)="goToAddCandidate()">
        <div class="action-icon add">
          <i class="fa-solid fa-user-plus"></i>
        </div>
        <div class="action-content">
          <h4>Add New Candidate</h4>
          <p>Add a new candidate to the election</p>
          <div class="action-hint">Add new candidates to the election</div>
        </div>
      </div>

      <!-- Change Election State -->
      <div class="action-card" (click)="goToChangeState()">
        <div class="action-icon state">
          <i class="fa-solid fa-exchange-alt"></i>
        </div>
        <div class="action-content">
          <h4>Change Election State</h4>
          <p>Change election state (Registration, Voting, Closed)</p>
          <div class="action-hint">Control election phases</div>
        </div>
      </div>

      <!-- View Users -->
      <div class="action-card" (click)="viewUsers()">
        <div class="action-icon users">
          <i class="fa-solid fa-users"></i>
        </div>
        <div class="action-content">
          <h4>View Users</h4>
          <p>View all registered voters and voting information</p>
          <div class="action-hint">Manage and track users easily</div>
        </div>
      </div>

      <!-- View Settings -->
      <div class="action-card" (click)="viewSettings()">
        <div class="action-icon settings">
          <i class="fa-solid fa-gear"></i>
        </div>
        <div class="action-content">
          <h4>View Settings</h4>
          <p>Dashboard and system settings</p>
          <div class="action-hint">Modify general system settings</div>
        </div>
      </div>

      <!-- Refresh Data -->
      <div class="action-card" (click)="refreshData()">
        <div class="action-icon refresh">
          <i class="fa-solid fa-sync-alt"></i>
        </div>
        <div class="action-content">
          <h4>Refresh Data</h4>
          <p>Refresh candidates and statistics data</p>
          <div class="action-hint">Update current data</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Current Candidates -->
  @if (candidates.length > 0) {
  <div class="candidates-section">
    <div class="section-header">
      <h2><i class="fa-solid fa-user-tie"></i> Current Candidates</h2>
      <div class="candidate-count">{{ candidates.length }} Candidates</div>
    </div>
    
    <div class="candidates-table">
      <div class="table-header">
        <div class="col">#</div>
        <div class="col">Name</div>
        <div class="col">Party</div>
        <div class="col">Age</div>
        <div class="col">Qualification</div>
        <div class="col">Votes Count</div>
        <div class="col">Percentage</div>
      </div>
      
      <div class="table-body">
        @for (candidate of candidates; track candidate.id; let i = $index) {
        <div class="table-row">
          <div class="col rank">
            <div class="candidate-rank" [class.top]="i < 3">
              @if (i === 0) {
                <i class="fa-solid fa-medal gold"></i>
              } @else if (i === 1) {
                <i class="fa-solid fa-medal silver"></i>
              } @else if (i === 2) {
                <i class="fa-solid fa-medal bronze"></i>
              } @else {
                <span>{{ i + 1 }}</span>
              }
            </div>
          </div>
          <div class="col name">{{ candidate.name }}</div>
          <div class="col">
            <span class="party-badge">{{ candidate.party }}</span>
          </div>
          <div class="col">{{ candidate.age }}</div>
          <div class="col">{{ candidate.qualification }}</div>
          <div class="col">
            <div class="votes-display">
              <span class="votes-count">{{ candidate.voteCount }}</span>
              <div class="progress-bar-small">
                <div class="progress-fill" 
                     [style.width]="(candidate.voteCount / getTotalVotes() * 100) + '%'"></div>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="percentage-badge">
              {{ totalVotes > 0 ? ((candidate.voteCount / totalVotes) * 100).toFixed(1) : 0 }}%
            </div>
          </div>
        </div>
        }
      </div>
    </div>
  </div>
  } @else {
  <div class="no-candidates">
    <div class="empty-state">
      <div class="empty-icon">
        <i class="fa-solid fa-users-slash"></i>
      </div>
      <h3>No Candidates Found</h3>
      <p>No candidates have been added yet. Start by adding the first candidate.</p>
      <button class="btn-primary" (click)="goToAddCandidate()">
        <i class="fa-solid fa-plus"></i> Add First Candidate
      </button>
    </div>
  </div>
  }

  <!-- Additional Stats -->
  @if (candidates.length > 0) {
  <div class="additional-stats">
    <div class="stat-row">
      <div class="stat-item">
        <div class="stat-icon">
          <i class="fa-solid fa-crown"></i>
        </div>
        <div class="stat-details">
          <h4>Leading Candidate</h4>
          <p class="stat-value">{{ getWinnerName() }}</p>
          <p class="stat-subvalue">{{ getWinnerVotes() }} votes</p>
        </div>
      </div>
      
      <div class="stat-item">
        <div class="stat-icon">
          <i class="fa-solid fa-chart-line"></i>
        </div>
        <div class="stat-details">
          <h4>Average Votes</h4>
          <p class="stat-value">{{ getAverageVotes() }}</p>
          <p class="stat-subvalue">votes per candidate</p>
        </div>
      </div>
      
      <div class="stat-item">
        <div class="stat-icon">
          <i class="fa-solid fa-bullseye"></i>
        </div>
        <div class="stat-details">
          <h4>Participation Rate</h4>
          <p class="stat-value">{{ totalVotes }}</p>
          <p class="stat-subvalue">total votes</p>
        </div>
      </div>
      
      <div class="stat-item">
        <div class="stat-icon">
          <i class="fa-solid fa-clock"></i>
        </div>
        <div class="stat-details">
          <h4>Last Updated</h4>
          <p class="stat-value">{{ lastUpdated | date:'shortTime' }}</p>
          <p class="stat-subvalue">minutes ago</p>
        </div>
      </div>
    </div>
  </div>
  }
</div>